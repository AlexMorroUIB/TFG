<!doctype html>
<html lang="ca">
<head>
  <title>Bellver Defense</title>
  <link rel="icon" type="image/x-icon" href="/img/favicon.ico">

  <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
  <script>
    delete AFRAME.components["grabbable"];
  </script>
  <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.4.0/dist/aframe-extras.min.js"></script>
  <script src="./js/aframe-aabb-collider-component.min.js"></script>
  <script src="./js/super-hands.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-physics-system@v4.2.2/dist/aframe-physics-system.js"></script>
  <script type="module" src="./js/main.js"></script>
</head>
<body>
<a-scene id="escena" physics="debug: true" obb-collider="showColliders: true">
  <a-assets>
    <!--    Mans -->
    <a-mixin id="mans" super-hands
             static-body="shape: sphere; sphereRadius: 0.02;"
             sphere-collider="objects: #arc, .fletxa;"></a-mixin>
    <a-mixin id="fletxa" fletxa grabbable="startButtons: triggerdown; endButtons: triggerup; maxGrabbers: 1"
             aabb-collider="objects: .enemic; interval: 20"></a-mixin>
    <a-mixin id="enemic" enemic></a-mixin>
    <a-mixin id="boto" boto></a-mixin>
    <a-mixin id="terra" terra="asset: #terraAsset"></a-mixin>
    <!--<a-mixin id="sticky-asset" hoverable
             grabbable="startButtons: triggerdown; endButtons: trackpadup"
             event-set__hoveron="_event: hover-start; material.opacity: 0.7; transparent: true"
             event-set__hoveroff="_event: hover-end; material.opacity: 1; transparent: false"></a-mixin>-->
    <a-asset-item id="cart" src="./assets/models/carttest.glb"></a-asset-item>
    <a-asset-item id="arcAsset" src="./assets/models/arctest.glb"></a-asset-item>
    <a-asset-item id="terraAsset" src="./assets/models/terra.glb"></a-asset-item>
    <img id="cel" src="./assets/textures/cel.jpg">
    <img id="terra" src="./assets/textures/terra.jpg">
    <img id="terra-nrm" src="./assets/textures/terra-nrm.jpg">
    <img id="terra-bosc" src="./assets/textures/terra-bosc.jpg">
    <img id="terra-bosc-nrm" src="./assets/textures/terra-bosc-nrm.jpg">
  </a-assets>
  <!-- Entitat de camera  position="-1 0 -6"-->
  <!-- constraint="target: #cart" -->

  <a-entity id="vagoneta" vagoneta="asset: #cart;">
    <a-sky src="#cel" rotation="0 94 0"></a-sky>
    <a-entity id="controls" rotation="0 180 0" position="0 0 -1">
      <!-- Altura dels ulls dels nins ~0.9 user-height="0.9" -->
      <a-camera active="true">
<!--        <a-plane id="hud"></a-plane>-->
      </a-camera>
      <a-entity id="maEsquerra" hand-controls="hand: left" mixin="mans"></a-entity>
      <a-entity id="maDreta" hand-controls="hand: right" mixin="mans"></a-entity>
      <!-- Ma esquerra
      <a-entity id="leftHand" mixin="mans" static-body physics-collider collision-filter super-hands
                hand-controls="hand: left" shadow="cast: false"
                velocity magicleap-controls vive-controls oculus-touch-controls windows-motion-controls
                hp-mixed-reality></a-entity>
      &lt;!&ndash; Ma dreta &ndash;&gt;
      <a-entity id="rightHand" mixin="mans" static-body physics-collider collision-filter super-hands
                hand-controls="hand: right" shadow="cast: false"º
                velocity magicleap-controls vive-controls oculus-touch-controls windows-motion-controls
                hp-mixed-reality></a-entity>-->
      <!--    Arc  arc="event: event1; message: Hello, Metaverse!"-->
    </a-entity>
    <!--  <a-entity id="arcComplet" position="-0.5 1 -5.5">
        <a-entity id="corda" corda="" class="" position="-0.48 0 0" grabbable draggable>
        </a-entity>
      </a-entity>-->
    <a-entity id="arc" arc="asset: #arcAsset;" class="" position="0 1 0"
              grabbable draggable>
    </a-entity>
  </a-entity>

  <!-- Terra
  ammojs:
   collisionFilterGroup: 1; collisionFilterMask: 1;
   shape="type: box"
   -->
  <a-entity terra="asset: #terraAsset;"></a-entity>
  <!--<a-plane
    material="color: #FFF; src: #terra; repeat: 1 6; normal-map: #terra-nrm; normal-texture-repeat: 1 6; normal-scale: 1 -1; roughness: 0.9"
    scale="4 200 2" rotation="-90 0 0" body="type: static;"
  ></a-plane>
  <a-plane material="color: #0000FF" position="-6 0 0"
           scale="8 200 0" rotation="-90 0 0" body="type: static;"></a-plane>
  <a-plane material="color: #0000FF" position="6 0 0"
           scale="8 200 0" rotation="-90 0 0" body="type: static;"></a-plane>-->

  <a-sphere grabbable class="enemic" color="#FFAA00" radius="0.5" position="-0.5 2 -4">
  </a-sphere>
  <!--  <a-entity geometry="box" position="-1 1 -2" color="#D9614C"></a-entity>-->
  <!--  <a-entity id="vagoneta" vagoneta="message: asdf" position="-1 1 -2"></a-entity>-->
  <!-- animacio quan el ratolí passa per damunt -->
  <a-entity grabbable class="boto"
            geometry="primitive: box"
            material="color: red"
            position="1 1 -4"
            animation__mouseenter="property: components.material.material.color; type: color; to: blue; startEvents: mouseenter; dur: 500"
            ;
            animation__mouseleave="property: components.material.material.color; type: color; to: red; startEvents: mouseleave; dur: 500"
            ;>
  </a-entity>
</a-scene>
</body>

</html>
